<%- include('adminHeader') %>
<div style="display: flex; height: 100vh">
    <%- include('sidebar') %>

    <div class="overflow-x-auto flex-grow: 2; font-[sans-serif] w-full">
        <table class="min-w-full w-full bg-white">
          <thead class="bg-gray-100 whitespace-nowrap">
            <tr>
              <th class="p-4 text-left text-sm font-semibold text-black">Product</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Price</th>
              <th class="p-4 text-left text-sm font-semibold text-black">In stock</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Publisher</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Category</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Action</th>
            </tr>
          </thead>
      
          <tbody class="whitespace-nowrap divide-y divide-gray-200">
            <% products.forEach(product => { %>
            <tr>
              <td class="p-4 text-sm">
                <div class="flex items-center cursor-pointer">
                  <img src="<%= product.image[0] %>" class="w-10 h-10 p-1.5 shrink-0 bg-gray-100" />
                  <div class="mx-4">
                    <p class="text-sm text-black"><%= product.product_name %></p>
                  </div>
                </div>
              </td>
              <td class="p-4 text-sm">
                $<%= product.price %>
              </td>
              <td class="p-4 text-sm">
                <%= product.stock %>
              </td>
              <td class="p-4 text-sm">
                <%= product.publisher %>
              </td>
              <td class="p-4 text-sm">
                <%= product.category ? product.category.collectionName : 'N/A' %>
              </td>
              <td class="p-4 text-sm">
                <button title="Edit">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 fill-gray-500" viewBox="0 0 32 32">
                    <path
                      d="M13 16c0 1.654 1.346 3 3 3s3-1.346 3-3-1.346-3-3-3-3 1.346-3 3zm0 10c0 1.654 1.346 3 3 3s3-1.346 3-3-1.346-3-3-3-3 1.346-3 3zm0-20c0 1.654 1.346 3 3 3s3-1.346 3-3-1.346-3-3-3-3 1.346-3 3z"
                      data-original="#000000" />
                  </svg>
                </button>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      
        <!-- Pagination Section -->
        <div class="md:flex m-4">
          <p class="text-sm text-gray-500 flex-1">
            Showing <%= (currentPage - 1) * limit + 1 %> to <%= Math.min(currentPage * limit, totalProducts) %> of <%= totalProducts %> entries
          </p>
          
          <!-- Pagination controls -->
          <div class="flex items-center max-md:mt-4">
            <p class="text-sm text-gray-500">Display</p>
            <select class="text-sm text-gray-500 border border-gray-400 rounded h-8 px-1 mx-4 outline-none" onchange="window.location.href='?page=1&limit=' + this.value">
              <option <%= limit == 5 ? 'selected' : '' %> value="5">5</option>
              <option <%= limit == 10 ? 'selected' : '' %> value="10">10</option>
              <option <%= limit == 20 ? 'selected' : '' %> value="20">20</option>
              <option <%= limit == 50 ? 'selected' : '' %> value="50">50</option>
              <option <%= limit == 100 ? 'selected' : '' %> value="100">100</option>
            </select>
      
            <ul class="flex space-x-1 ml-4">
              <!-- Previous Page Link -->
              <% if (hasPreviousPage) { %>
              <li class="flex items-center justify-center cursor-pointer bg-gray-200 w-8 h-8 rounded">
                <a href="?page=<%= currentPage - 1 %>&limit=<%= limit %>">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3 fill-gray-500" viewBox="0 0 55.753 55.753">
                    <path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 0 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z" />
                  </svg>
                </a>
              </li>
              <% } %>
      
              <!-- Page Numbers -->
              <% for (let i = 1; i <= totalPages; i++) { %>
              <li class="flex items-center justify-center cursor-pointer text-sm w-8 h-8 rounded <%= currentPage === i ? 'bg-[#007bff] text-white' : '' %>">
                <a href="?page=<%= i %>&limit=<%= limit %>"><%= i %></a>
              </li>
              <% } %>
      
              <!-- Next Page Link -->
              <% if (hasNextPage) { %>
              <li class="flex items-center justify-center cursor-pointer bg-gray-200 w-8 h-8 rounded">
                <a href="?page=<%= currentPage + 1 %>&limit=<%= limit %>">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3 fill-gray-500 rotate-180" viewBox="0 0 55.753 55.753">
                    <path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 0 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z" />
                  </svg>
                </a>
              </li>
              <% } %>
            </ul>
          </div>
        </div>
      </div>
      