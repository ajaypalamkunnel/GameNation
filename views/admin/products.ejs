<%- include('adminHeader') %>
<div style="display: flex; height: 100vh">
    <%- include('sidebar') %>
    

    <div class="overflow-x-auto flex-grow: 2; font-[sans-serif] w-full">
      <form class="w-full  flex items-center bg-gray-800">
        <input type="text" class="w-3/6 mt-5  ml-4 mb-3 border rounded-lg p-2  h-8 text-sm" placeholder="Search by user name...">
        <button type="submit" class="bg-green-400  ml-4 mt-5 mb-3 text-white p-2 h-8 text-sm rounded-lg hover:bg-blue-700">Search</button>
        
        <a href="/addProduct" class="bg-green-400  ml-4 mt-5 mb-3 text-white p-2 h-8 text-sm rounded-lg hover:bg-blue-700">Add product</a>
        
  
    </form>
        <table class="min-w-full w-full bg-white">
          <thead class="bg-gray-100 whitespace-nowrap">
            <tr>
              <th class="p-4 text-left text-sm font-semibold text-black">Product</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Price</th>
              <th class="p-4 text-left text-sm font-semibold text-black">In stock</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Publisher</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Category</th>
              <th class="p-4 text-left text-sm font-semibold text-black">Action</th>
            </tr>
          </thead>
      
          <tbody class="whitespace-nowrap divide-y divide-gray-200">
            <% products.forEach(product => { %>
            <tr>
              <td class="p-4 text-sm">
                <div class="flex items-center cursor-pointer">
                  <img src="<%= product.image[0] %>" class="w-10 h-10 p-1.5 shrink-0 bg-gray-100" />
                  <div class="mx-4">
                    <p class="text-sm text-black"><%= product.product_name %></p>
                  </div>
                </div>
              </td>
              <td class="p-4 text-sm">
                $<%= product.price %>
              </td>
              <td class="p-4 text-sm">
                <%= product.stock %>
              </td>
              <td class="p-4 text-sm">
                <%= product.publisher %>
              </td>
              <td class="p-4 text-sm">
                <%= product.category  ? product.category.collectionName : 'N/A' %>
              </td>
              <td class="p-4 text-sm">
                <div class="font-[sans-serif] space-x-4 space-y-4 text-center">
                  
                  <a  href="/admin/editProduct?id=<%= product._id %>"  class="h-8 px-5 py-2 rounded-lg text-white text-sm tracking-wider font-medium border border-current outline-none bg-custom-yellow hover:bg-green-800 active:bg-green-700">Edit</a>
                  <button type="button"
                  class="h-8 px-5 py-2 rounded-lg text-white text-sm tracking-wider font-medium border border-current outline-none bg-[#d02c2c] hover:bg-[#b63131] active:bg-green-700">Delete</button>
                </div>
                
                

              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      
        <!-- Pagination Section -->
        <div class="md:flex m-4">
          <p class="text-sm text-gray-500 flex-1">
            Showing <%= (currentPage - 1) * limit + 1 %> to <%= Math.min(currentPage * limit, totalProducts) %> of <%= totalProducts %> entries
          </p>
          
          <!-- Pagination controls -->
          <div class="flex items-center max-md:mt-4">
            <p class="text-sm text-gray-500">Display</p>
            <select class="text-sm text-gray-500 border border-gray-400 rounded h-8 px-1 mx-4 outline-none" onchange="window.location.href='?page=1&limit=' + this.value">
              <option <%= limit == 5 ? 'selected' : '' %> value="5">5</option>
              <option <%= limit == 10 ? 'selected' : '' %> value="10">10</option>
              <option <%= limit == 20 ? 'selected' : '' %> value="20">20</option>
              <option <%= limit == 50 ? 'selected' : '' %> value="50">50</option>
              <option <%= limit == 100 ? 'selected' : '' %> value="100">100</option>
            </select>
      
            <ul class="flex space-x-1 ml-4">
              <!-- Previous Page Link -->
              <% if (hasPreviousPage) { %>
              <li class="flex items-center justify-center cursor-pointer bg-gray-200 w-8 h-8 rounded">
                <a href="?page=<%= currentPage - 1 %>&limit=<%= limit %>">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3 fill-gray-500" viewBox="0 0 55.753 55.753">
                    <path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 0 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z" />
                  </svg>
                </a>
              </li>
              <% } %>
      
              <!-- Page Numbers -->
              <% for (let i = 1; i <= totalPages; i++) { %>
              <li class="flex items-center justify-center cursor-pointer text-sm w-8 h-8 rounded <%= currentPage === i ? 'bg-[#007bff] text-white' : '' %>">
                <a href="?page=<%= i %>&limit=<%= limit %>"><%= i %></a>
              </li>
              <% } %>
      
              <!-- Next Page Link -->
              <% if (hasNextPage) { %>
              <li class="flex items-center justify-center cursor-pointer bg-gray-200 w-8 h-8 rounded">
                <a href="?page=<%= currentPage + 1 %>&limit=<%= limit %>">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3 fill-gray-500 rotate-180" viewBox="0 0 55.753 55.753">
                    <path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 0 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z" />
                  </svg>
                </a>
              </li>
              <% } %>
            </ul>
          </div>
        </div>
      </div>
      